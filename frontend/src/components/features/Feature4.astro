---
// foundations
import Text from "@/components/foundations/elements/Text.astro";
import Link from "@/components/foundations/elements/Link.astro";
import Wrapper from "@/components/foundations/containers/Wrapper.astro";
import PortableText from "@/components/foundations/elements/PortableText.astro";
import IconRenderer from "@/components/foundations/elements/IconRenderer.astro";

interface Props {
  feature?: {
    header?: string;
    subheading?: any[];
    firstFeature?: {
      icon: {
        assetUrl?: string;
        alt?: string;
      };
      title: string;
      subheading: any[];
      ctaLabel?: string;
      ctaHref?: string;
    };
    secondFeature?: {
      icon: {
        assetUrl?: string;
        alt?: string;
      };
      title: string;
      subheading: any[];
      ctaLabel?: string;
      ctaHref?: string;
    };
  };
}

const { feature } = Astro.props;
const { header, subheading, firstFeature, secondFeature } = feature || {};

// Don't render if no feature data
if (!feature || (!firstFeature && !secondFeature)) {
  return null;
}
---

<section class="feature-4">
  <Wrapper variant="standard" class="flex flex-col py-12 border-t gap-24">
    {firstFeature && (
      <div class="items-start grid grid-cols-1 md:grid-cols-2 gap-12 feature-first">
        <div class="flex flex-col justify-between h-full text-balance gap-4">
          <div class="inline-flex p-4 rounded-lg bg-sand-100 w-fit feature-icon">
            <IconRenderer icon={firstFeature.icon} size="base" class="text-accent-600" />
          </div>
          <div>
            <Text
              tag="h2"
              variant="displaySM"
              class="font-serif font-medium tracking-tight brand-heading-color feature-title"
            >
              {firstFeature.title}
            </Text>
            <div class="max-w-xl mt-4 brand-text-color feature-description">
              <PortableText value={firstFeature.subheading} />
            </div>
            {firstFeature.ctaLabel && firstFeature.ctaHref && (
              <div class="flex mt-4">
                <Link size="sm" variant="accent" href={firstFeature.ctaHref}>{firstFeature.ctaLabel}</Link>
              </div>
            )}
          </div>
        </div>
        <div
          aria-hidden="true"
          class="p-8 pb-0 pr-0 overflow-hidden bg-sand-100 rounded-xl group feature-visual"
        >
          <div
            class="max-w-md p-4 mx-auto -mb-1 -mr-1 bg-white rounded-tl-xl shadow-sm outline outline-sand-500/10"
          >
            <div class="flex items-center gap-4">
              <div
                class="inline-flex p-4 rounded-lg bg-sand-100 duration-300 group-hover:-rotate-12 group-hover:-translate-y-2"
              >
                <IconRenderer icon={firstFeature.icon} size="sm" />
              </div>
              <div>
                <p class="text-sm brand-text-color">Audience</p>
                <p class="text-base font-medium text-base-900">
                  Newsletter Subscribers
                </p>
              </div>
            </div>
            <div
              class="pt-4 mt-4 border-t grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-3 border-base-100 gap-y-8"
            >
              <div>
                <p class="text-sm brand-text-color">All Contacts</p>
                <p class="text-base font-medium text-base-900">1,034</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Unsubscribed</p>
                <p class="text-base font-medium text-base-900">5</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Growth</p>
                <p class="text-base font-medium text-base-900">+1,034 (+10%)</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Open Rate</p>
                <p class="text-base font-medium text-base-900">42%</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Click Rate</p>
                <p class="text-base font-medium text-base-900">18%</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Bounce Rate</p>
                <p class="text-base font-medium text-base-900">1.5%</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Spam Reports</p>
                <p class="text-base font-medium text-base-900">2</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Avg. Response Time</p>
                <p class="text-base font-medium text-base-900">4.2s</p>
              </div>
              <div>
                <p class="text-sm brand-text-color">Unopened Emails</p>
                <p class="text-base font-medium text-base-900">612</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    )}
    
    {secondFeature && (
      <div class="items-center grid grid-cols-1 md:grid-cols-2 gap-12 feature-second">
        <div
          class="flex flex-col justify-between h-full text-balance gap-4 lg:order-last"
        >
          <div class="inline-flex p-4 rounded-lg bg-sand-100 w-fit feature-icon">
            <IconRenderer icon={secondFeature.icon} size="base" class="text-accent-600" />
          </div>
          <div>
            <Text
              tag="h2"
              variant="displaySM"
              class="font-serif font-medium tracking-tight brand-heading-color feature-title"
            >
              {secondFeature.title}
            </Text>
            <div class="max-w-xl mt-4 brand-text-color feature-description">
              <PortableText value={secondFeature.subheading} />
            </div>
            {secondFeature.ctaLabel && secondFeature.ctaHref && (
              <div class="flex mt-4">
                <Link size="sm" variant="accent" href={secondFeature.ctaHref}>{secondFeature.ctaLabel}</Link>
              </div>
            )}
          </div>
        </div>
        <div
          aria-hidden="true"
          class="p-8 pb-0 pl-0 overflow-hidden bg-sand-100 rounded-xl group feature-visual"
        >
          <div class="flex flex-col gap-4">
            <div
              class="p-6 bg-white shadow rounded-r-xl outline outline-sand-500/10"
            >
              <p class="text-sm brand-text-color">Deliverability</p>
              <p class="mt-2 text-4xl font-medium text-base-900">98%</p>
              <div class="mt-6 space-y-2">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span
                      class="size-3 rounded-full group-hover:-translate-x-2 duration-300 bg-[#5aab69]"
                    ></span>
                    <span class="text-sm text-base-600">Delivered</span>
                  </div>
                  <span class="text-sm font-medium text-base-900">3,204</span>
                </div>
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span
                      class="size-3 rounded-full group-hover:-translate-x-2 duration-300 bg-[#ff421e]"
                    ></span>
                    <span class="text-sm text-base-600">Bounced</span>
                  </div>
                  <span class="text-sm font-medium text-base-900">60</span>
                </div>
              </div>
            </div>
            <div
              class="p-6 -mb-1 bg-white shadow rounded-tr-xl outline outline-sand-500/10"
            >
              <p class="text-sm brand-text-color">Engagement</p>
              <p class="mt-2 text-4xl font-medium text-base-900">41%</p>
              <div class="mt-6 space-y-2">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span
                      class="size-3 rounded-full group-hover:-translate-x-2 duration-300 bg-[#60beff]"
                    ></span>
                    <span class="text-sm text-base-600">Opened</span>
                  </div>
                  <span class="text-sm font-medium text-base-900">1,350</span>
                </div>
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2">
                    <span
                      class="size-3 rounded-full group-hover:-translate-x-2 duration-300 bg-[#e3962d]"
                    ></span>
                    <span class="text-sm text-base-600">Clicked</span>
                  </div>
                  <span class="text-sm font-medium text-base-900">472</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    )}
  </Wrapper>
</section>
